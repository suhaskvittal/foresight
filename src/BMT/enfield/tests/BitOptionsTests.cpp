#include "gtest/gtest.h"

#include "enfield/Support/BitOptions.h"

#include <string>

using namespace efd;

template <int Last>
void TestBitOptions() {
    BitOptions<int, Last> bitOpt;

    uint32_t ElemSize = sizeof(uint8_t) * 8;
    uint32_t TotalSize = ((Last - 1) / ElemSize) + 1;

    for (uint32_t i = 0; i < Last; ++i) {
        EXPECT_FALSE(bitOpt.get(i));
        bitOpt.set(i);
        EXPECT_TRUE(bitOpt.get(i));
    }

    for (uint32_t i = Last + 1, e = ElemSize * TotalSize; i < e; ++i) {
        EXPECT_DEATH({ bitOpt.get(i); }, "");
    }
}

TEST(BitOptionsTests, SingleTest) {
    TestBitOptions<0>();
    TestBitOptions<1>();
    TestBitOptions<2>();
    TestBitOptions<3>();
    TestBitOptions<4>();
    TestBitOptions<5>();
    TestBitOptions<6>();
    TestBitOptions<7>();
    TestBitOptions<8>();
    TestBitOptions<9>();
    TestBitOptions<10>();
    TestBitOptions<11>();
    TestBitOptions<12>();
    TestBitOptions<13>();
    TestBitOptions<14>();
    TestBitOptions<15>();
    TestBitOptions<16>();
    TestBitOptions<17>();
    TestBitOptions<18>();
    TestBitOptions<19>();
    TestBitOptions<20>();
    TestBitOptions<21>();
    TestBitOptions<22>();
    TestBitOptions<23>();
    TestBitOptions<24>();
    TestBitOptions<25>();
    TestBitOptions<26>();
    TestBitOptions<27>();
    TestBitOptions<28>();
    TestBitOptions<29>();
    TestBitOptions<30>();
    TestBitOptions<31>();
    TestBitOptions<32>();
    TestBitOptions<33>();
    TestBitOptions<34>();
    TestBitOptions<35>();
    TestBitOptions<36>();
    TestBitOptions<37>();
    TestBitOptions<38>();
    TestBitOptions<39>();
    TestBitOptions<40>();
    TestBitOptions<41>();
    TestBitOptions<42>();
    TestBitOptions<43>();
    TestBitOptions<44>();
    TestBitOptions<45>();
    TestBitOptions<46>();
    TestBitOptions<47>();
    TestBitOptions<48>();
    TestBitOptions<49>();
    TestBitOptions<50>();
    TestBitOptions<51>();
    TestBitOptions<52>();
    TestBitOptions<53>();
    TestBitOptions<54>();
    TestBitOptions<55>();
    TestBitOptions<56>();
    TestBitOptions<57>();
    TestBitOptions<58>();
    TestBitOptions<59>();
    TestBitOptions<60>();
    TestBitOptions<61>();
    TestBitOptions<62>();
    TestBitOptions<63>();
    TestBitOptions<64>();
    TestBitOptions<65>();
    TestBitOptions<66>();
    TestBitOptions<67>();
    TestBitOptions<68>();
    TestBitOptions<69>();
    TestBitOptions<70>();
    TestBitOptions<71>();
    TestBitOptions<72>();
    TestBitOptions<73>();
    TestBitOptions<74>();
    TestBitOptions<75>();
    TestBitOptions<76>();
    TestBitOptions<77>();
    TestBitOptions<78>();
    TestBitOptions<79>();
    TestBitOptions<80>();
    TestBitOptions<81>();
    TestBitOptions<82>();
    TestBitOptions<83>();
    TestBitOptions<84>();
    TestBitOptions<85>();
    TestBitOptions<86>();
    TestBitOptions<87>();
    TestBitOptions<88>();
    TestBitOptions<89>();
    TestBitOptions<90>();
    TestBitOptions<91>();
    TestBitOptions<92>();
    TestBitOptions<93>();
    TestBitOptions<94>();
    TestBitOptions<95>();
    TestBitOptions<96>();
    TestBitOptions<97>();
    TestBitOptions<98>();
    TestBitOptions<99>();
    TestBitOptions<100>();
    TestBitOptions<101>();
    TestBitOptions<102>();
    TestBitOptions<103>();
    TestBitOptions<104>();
    TestBitOptions<105>();
    TestBitOptions<106>();
    TestBitOptions<107>();
    TestBitOptions<108>();
    TestBitOptions<109>();
    TestBitOptions<110>();
    TestBitOptions<111>();
    TestBitOptions<112>();
    TestBitOptions<113>();
    TestBitOptions<114>();
    TestBitOptions<115>();
    TestBitOptions<116>();
    TestBitOptions<117>();
    TestBitOptions<118>();
    TestBitOptions<119>();
    TestBitOptions<120>();
    TestBitOptions<121>();
    TestBitOptions<122>();
    TestBitOptions<123>();
    TestBitOptions<124>();
    TestBitOptions<125>();
    TestBitOptions<126>();
    TestBitOptions<127>();
    TestBitOptions<128>();
    TestBitOptions<129>();
    TestBitOptions<130>();
    TestBitOptions<131>();
    TestBitOptions<132>();
    TestBitOptions<133>();
    TestBitOptions<134>();
    TestBitOptions<135>();
    TestBitOptions<136>();
    TestBitOptions<137>();
    TestBitOptions<138>();
    TestBitOptions<139>();
    TestBitOptions<140>();
    TestBitOptions<141>();
    TestBitOptions<142>();
    TestBitOptions<143>();
    TestBitOptions<144>();
    TestBitOptions<145>();
    TestBitOptions<146>();
    TestBitOptions<147>();
    TestBitOptions<148>();
    TestBitOptions<149>();
    TestBitOptions<150>();
    TestBitOptions<151>();
    TestBitOptions<152>();
    TestBitOptions<153>();
    TestBitOptions<154>();
    TestBitOptions<155>();
    TestBitOptions<156>();
    TestBitOptions<157>();
    TestBitOptions<158>();
    TestBitOptions<159>();
    TestBitOptions<160>();
    TestBitOptions<161>();
    TestBitOptions<162>();
    TestBitOptions<163>();
    TestBitOptions<164>();
    TestBitOptions<165>();
    TestBitOptions<166>();
    TestBitOptions<167>();
    TestBitOptions<168>();
    TestBitOptions<169>();
    TestBitOptions<170>();
    TestBitOptions<171>();
    TestBitOptions<172>();
    TestBitOptions<173>();
    TestBitOptions<174>();
    TestBitOptions<175>();
    TestBitOptions<176>();
    TestBitOptions<177>();
    TestBitOptions<178>();
    TestBitOptions<179>();
    TestBitOptions<180>();
    TestBitOptions<181>();
    TestBitOptions<182>();
    TestBitOptions<183>();
    TestBitOptions<184>();
    TestBitOptions<185>();
    TestBitOptions<186>();
    TestBitOptions<187>();
    TestBitOptions<188>();
    TestBitOptions<189>();
    TestBitOptions<190>();
    TestBitOptions<191>();
    TestBitOptions<192>();
    TestBitOptions<193>();
    TestBitOptions<194>();
    TestBitOptions<195>();
    TestBitOptions<196>();
    TestBitOptions<197>();
    TestBitOptions<198>();
    TestBitOptions<199>();
    TestBitOptions<200>();
    TestBitOptions<201>();
    TestBitOptions<202>();
    TestBitOptions<203>();
    TestBitOptions<204>();
    TestBitOptions<205>();
    TestBitOptions<206>();
    TestBitOptions<207>();
    TestBitOptions<208>();
    TestBitOptions<209>();
    TestBitOptions<210>();
    TestBitOptions<211>();
    TestBitOptions<212>();
    TestBitOptions<213>();
    TestBitOptions<214>();
    TestBitOptions<215>();
    TestBitOptions<216>();
    TestBitOptions<217>();
    TestBitOptions<218>();
    TestBitOptions<219>();
    TestBitOptions<220>();
    TestBitOptions<221>();
    TestBitOptions<222>();
    TestBitOptions<223>();
    TestBitOptions<224>();
    TestBitOptions<225>();
    TestBitOptions<226>();
    TestBitOptions<227>();
    TestBitOptions<228>();
    TestBitOptions<229>();
    TestBitOptions<230>();
    TestBitOptions<231>();
    TestBitOptions<232>();
    TestBitOptions<233>();
    TestBitOptions<234>();
    TestBitOptions<235>();
    TestBitOptions<236>();
    TestBitOptions<237>();
    TestBitOptions<238>();
    TestBitOptions<239>();
    TestBitOptions<240>();
    TestBitOptions<241>();
    TestBitOptions<242>();
    TestBitOptions<243>();
    TestBitOptions<244>();
    TestBitOptions<245>();
    TestBitOptions<246>();
    TestBitOptions<247>();
    TestBitOptions<248>();
    TestBitOptions<249>();
    TestBitOptions<250>();
    TestBitOptions<251>();
    TestBitOptions<252>();
    TestBitOptions<253>();
    TestBitOptions<254>();
    TestBitOptions<255>();
    TestBitOptions<256>();
    TestBitOptions<257>();
}
